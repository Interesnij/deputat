{% load filters %}

<div class="card" style="margin-bottom: .5rem;">
    <div class="card-body" style="padding: .5rem .5rem;">
        <div class="media">
            <div class="avatar mr-75">
              <a href="{% url 'user' pk=comment.commenter.pk %}" class="ajax">
                <img src="{{ comment.commenter.get_avatar }}" width="38" height="38" alt="Avatar">
              </a>
            </div>
            <div class="media-body">
                <h6 class="font-weight-bolder mb-25">
                  <a href="{% url 'user' pk=comment.commenter.pk %}" class="ajax">
                    <span class="first_name">{{ comment.commenter.first_name }}</span> {{ comment.commenter.last_name }}
                  </a>
                </h6>
                <span class="text-muted small">{{ comment.get_created }}</span><br>
            </div>
        </div>
        <div class="media-footer"  data-pk="{{ comment.pk }}">
        <span class="card-text">{{ comment.text }}</span><br>

        {% if comment.is_have_docs %}
        is_have_docs
        {% endif %}
        {% if comment.is_have_images %}
          {% for image in comment.get_images %}
            <span style="flex-basis: 50%;">
              <img src="{{ image.file.url }}" class="image_fit_150" alt="img">
            </span>
          {% endfor %}
        {% endif %}

            <div class="d-inline-flex align-items-center pointer">
              <span class="like blog_comment_like {% if comment.likes|user_in:request.user %}btn_success{% else %}btn_default{% endif %} pointer" title="Нравится">
                <svg class="svg_info" fill="currentColor" viewBox="0 0 24 24"><path d="M0 0h24v24H0V0zm0 0h24v24H0V0z" fill="none"></path><path d="M9 21h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.58 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2zM9 9l4.34-4.34L12 10h9v2l-3 7H9V9zM1 9h4v12H1z"></path></svg>
                <span class="likes_count">{{ comment.likes_count }}</span>
              </span>
              &nbsp;&nbsp;
              <svg class="svg_info reply_comment" fill="currentColor" viewBox="0 0 24 24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z"/></svg>

            </div>

            <div style="display:none;padding-top: 5px;">
            <form class="form">
              {% csrf_token %}

                    <div class="col-12">
                      <div class="row attach_block"></div>
                      <span style="display:flex">
                      <span class="dropdown files_null">
                        <a class="btn btn-link btn-sm text-secondary drop" style="padding: 0;margin-top: 7px;">
                          <svg fill="currentColor" class="svg_info svg_default" viewBox="0 0 24 24"><path d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
                        </a>
                        <div class="dropdown-menu">
                          <a class="dropdown-item add_comment_photo">Добавить изображение</a>
                          <a class="dropdown-item add_comment_doc">Добавить документ</a>
                        </div>
                      </span>
                      <input name="text" class="form-control text-comment" style="margin-bottom:5px">
                      </span>

                      <input type="hidden" name="post_comment" value="{{ comment.pk }}">
                      <button type="button" class="btn btn-danger btn-sm hide_comment_form float-right" style="margin-left:5px">x</button>
                      <button type="button" class="btn btn-primary btn-sm blogReplyComment float-right">Комментировать</button>
                    </div>
            </form>
            </div>
          </div>

    </div>
    <span style="cursor:pointer;text-align:center" class="show_replies content-color-primary">
      {% if comment.count_replies %}
    ----  {{ comment.count_replies_ru }} ----
      {% endif %}
    </span>

    <span class="stream_reply_comments" style="display:none">
      {% for reply in comment.get_replies %}
        {% if reply.is_deleted %}
          <div class="card">
            <div class="card-body">
              <p style="display: flex; padding-left:10px;margin: 0;text-decoration:underline">Комментарий удален</p>
            </div>
          </div>
        {% else %}
          {% include 'blog/comment/reply.html' %}
        {% endif %}
      {% endfor %}
    </span>
</div>
